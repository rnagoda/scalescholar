appId: com.nagodasoft.scalescholar
---
# Test: Ear School Lesson Flow
# Verifies: Play -> Answer -> Feedback -> Next cycle

- launchApp:
    clearState: true

# Navigate to Ear School
- tapOn:
    id: "ear-school-card"

- assertVisible:
    id: "ear-school-header-title"

# Open Section 1
- tapOn:
    id: "section-1-card"

- assertVisible:
    id: "section-1-header-title"

# Open Lesson 1.1
- tapOn:
    id: "lesson-1-1-card"

# Verify intro screen loaded
- assertVisible:
    id: "lesson-ear-school-1.1-intro-header"

# Tap BEGIN to start exercises
- tapOn:
    id: "begin-lesson-button"

# Verify progress indicator is visible
- assertVisible:
    id: "progress-indicator"

# Tap the play button
- tapOn:
    id: "play-button"

# Wait for answering state
- extendedWaitUntil:
    visible:
      id: "play-hint"
    timeout: 5000

# Verify replay button is available
- assertVisible:
    id: "replay-button"

# Tap an answer (any solfege option - testing flow, not correctness)
- tapOn:
    text: "Do"

# Verify feedback is shown (next button appears)
- extendedWaitUntil:
    visible:
      id: "next-button"
    timeout: 3000

# Tap next to go to question 2
- tapOn:
    id: "next-button"

# Should be back in ready state - verify play button
- assertVisible:
    id: "play-button"

# Close the lesson
- tapOn:
    id: "lesson-ear-school-1.1-close-button"

# Confirm leave dialog appears (since session not complete)
- extendedWaitUntil:
    visible:
      text: "Leave"
    timeout: 3000

# Tap Leave to confirm
- tapOn:
    text: "Leave"

# Should be back at section detail
- assertVisible:
    id: "section-1-header-title"

# Navigate back to home
- tapOn:
    id: "section-1-close-button"

- tapOn:
    id: "ear-school-close-button"

- assertVisible:
    id: "home-header-title"
